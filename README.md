# cryptonomicon

## Modular KEM double ratchet

Why would you want a KEM double ratchet? It's design is superior in every way to the NIKE double ratchet; besides it being way better for composing fully hybrid post quantum ratchets, it achieves post compromise security in 2 rounds. Just because it uses a KEM doesn't mean you can't use a NIKE; as with Xwing, you can simply compose NIKEs as KEMs using an adhoc hashed ElGamal construction.


This modular KEM double ratchet design comes from the following 2020 paper:

* [The Double Ratchet: Security Notions, Proofs, and Modularization for the Signal Protocol](https://eprint.iacr.org/2018/1037)

* Read the autogenerated go docs for this project, here: [Go docs for cryptonomicon](https://pkg.go.dev/github.com/katzenpost/cryptonomicon)

* Partially written ProVerif model of the modular KEM double ratchet is here -->

https://github.com/katzenpost/formal_specifications/blob/main/kem_ratchet/cka.pv


* Nim language prototype of the modular KEM double ratchet:

https://github.com/katzenpost/formal_specifications/blob/main/kem_ratchet/prototype/kem_double_ratchet/src/kem_double_ratchet.nim


## Status

It works.


## Cryptography suite

This implementation of the modular KEM double ratchet uses the [hpqc](https://github.com/katzenpost/hpqc) cryptography library and thus has what is now known in modern parlance as "cryptographic agility" via golang interfaces. Thus, we can use *any* KEM with this KEM double ratchet and if you aren't completely satisfied any of the available KEMs then roll your own KEM. Combine your favorite classical NIKE with your favorite Post Quantum KEM if Xwing is not the hybrid KEM you are looking for:

```
	combiner.New(
		"MLKEM768-X448",
		[]kem.Scheme{
			adapter.FromNIKE(x448.Scheme(rand.Reader)),
			mlkem768.Scheme(),
		},
	),
```


## License

AGPLv3
